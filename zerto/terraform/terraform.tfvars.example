###############################################################################
# EXEMPLE DE CONFIGURATION - ZERTO DISASTER RECOVERY sur VMware vSphere
###############################################################################
# Description: Fichier d'exemple pour les variables Terraform
# Platform: OVHcloud Hosted Private Cloud (VMware vSphere)
# Usage: Copier ce fichier en terraform.tfvars et remplir avec vos valeurs
#        cp terraform.tfvars.example terraform.tfvars
###############################################################################

###############################################################################
# ENVIRONNEMENT
###############################################################################

environment = "production"

common_tags = {
  "Project"     = "POC-PRA"
  "ManagedBy"   = "Terraform"
  "Solution"    = "Zerto"
  "Platform"    = "VMware-vSphere"
  "CostCenter"  = "IT-Infrastructure"
  "Owner"       = "ops-team@exemple.com"
}

###############################################################################
# VCENTER RBX (ROUBAIX)
###############################################################################

vcenter_rbx_server     = "pcc-xxx-xxx-xxx.ovh.com"
vcenter_rbx_user       = "admin@vsphere.local"
vcenter_rbx_password   = "VOTRE_MOT_DE_PASSE_RBX"
vcenter_rbx_datacenter = "pcc-xxx-xxx-xxx-rbx"
vcenter_rbx_cluster    = "Cluster1"

###############################################################################
# VCENTER SBG (STRASBOURG)
###############################################################################

vcenter_sbg_server     = "pcc-yyy-yyy-yyy.ovh.com"
vcenter_sbg_user       = "admin@vsphere.local"
vcenter_sbg_password   = "VOTRE_MOT_DE_PASSE_SBG"
vcenter_sbg_datacenter = "pcc-yyy-yyy-yyy-sbg"
vcenter_sbg_cluster    = "Cluster1"

###############################################################################
# CONFIGURATION ZERTO
###############################################################################

zerto_site_id_rbx = "SITE_ID_RBX_DEPUIS_CONSOLE_ZERTO"
zerto_site_id_sbg = "SITE_ID_SBG_DEPUIS_CONSOLE_ZERTO"

# API Zerto (optionnel, peut utiliser username/password)
zerto_api_endpoint = "https://zerto-api.ovh.net"
zerto_api_token    = "VOTRE_TOKEN_API_ZERTO"

# RPO de 5 minutes (300 secondes)
zerto_rpo_seconds = 300

# Rétention du journal de 24 heures
zerto_journal_hours = 24

# Tests automatiques tous les 7 jours (168 heures)
zerto_test_interval = 168

# Configuration avancée
zerto_priority_high      = "High"
zerto_enable_compression = true
zerto_enable_encryption  = true
zerto_wan_acceleration   = true

###############################################################################
# VMs PROTÉGÉES - RBX
###############################################################################
# IMPORTANT: vm_name_vcenter doit correspondre EXACTEMENT au nom dans vCenter

rbx_protected_vms = [
  {
    name            = "rbx-app-prod-01"
    vm_name_vcenter = "rbx-app-prod-01"  # Nom EXACT dans vCenter RBX
    boot_order      = 2                   # Démarre après la DB
    failover_ip     = "10.1.1.10"
    failover_subnet = "10.1.1.0/24"
    description     = "Serveur d'application production RBX"
  },
  {
    name            = "rbx-db-prod-01"
    vm_name_vcenter = "rbx-db-prod-01"   # Nom EXACT dans vCenter RBX
    boot_order      = 1                   # Démarre en premier
    failover_ip     = "10.1.1.20"
    failover_subnet = "10.1.1.0/24"
    description     = "Serveur de base de données production RBX"
  }
]

###############################################################################
# VMs PROTÉGÉES - SBG
###############################################################################
# IMPORTANT: vm_name_vcenter doit correspondre EXACTEMENT au nom dans vCenter

sbg_protected_vms = [
  {
    name            = "sbg-app-prod-01"
    vm_name_vcenter = "sbg-app-prod-01"  # Nom EXACT dans vCenter SBG
    boot_order      = 2
    failover_ip     = "10.2.1.10"
    failover_subnet = "10.2.1.0/24"
    description     = "Serveur d'application production SBG"
  },
  {
    name            = "sbg-db-prod-01"
    vm_name_vcenter = "sbg-db-prod-01"   # Nom EXACT dans vCenter SBG
    boot_order      = 1  # Démarre en premier
    failover_ip     = "10.2.1.20"
    failover_subnet = "10.2.1.0/24"
    description     = "Serveur de base de données production SBG"
  }
]

###############################################################################
# CONFIGURATION RÉSEAU VMWARE - RBX
###############################################################################

# Nom du réseau vSphere (doit exister dans vCenter RBX)
rbx_target_network_name = "VM Network"

# Nom du datastore pour le journal Zerto (doit exister dans vCenter RBX)
rbx_journal_datastore = "datastore1"

rbx_failover_network_config = {
  gateway       = "10.1.1.1"
  dns_primary   = "213.186.33.99"  # DNS OVH
  dns_secondary = "8.8.8.8"         # DNS Google
  domain_name   = "rbx.prod.local"
}

rbx_network_ranges = ["10.1.0.0/16", "10.1.1.0/24"]

###############################################################################
# CONFIGURATION RÉSEAU VMWARE - SBG
###############################################################################

# Nom du réseau vSphere (doit exister dans vCenter SBG)
sbg_target_network_name = "VM Network"

# Nom du datastore pour le journal Zerto (doit exister dans vCenter SBG)
sbg_journal_datastore = "datastore1"

sbg_failover_network_config = {
  gateway       = "10.2.1.1"
  dns_primary   = "213.186.33.99"  # DNS OVH
  dns_secondary = "8.8.8.8"         # DNS Google
  domain_name   = "sbg.prod.local"
}

sbg_network_ranges = ["10.2.0.0/16", "10.2.1.0/24"]

###############################################################################
# CONFIGURATION FORTIGATE - RBX
###############################################################################

rbx_fortigate_ip      = "10.1.0.1"
rbx_fortigate_api_key = "VOTRE_API_KEY_FORTIGATE_RBX"

rbx_fortigate_vip_range    = "10.1.100.0/24"
rbx_fortigate_internal_if  = "port1"
rbx_fortigate_external_if  = "port2"

###############################################################################
# CONFIGURATION FORTIGATE - SBG
###############################################################################

sbg_fortigate_ip      = "10.2.0.1"
sbg_fortigate_api_key = "VOTRE_API_KEY_FORTIGATE_SBG"

sbg_fortigate_vip_range    = "10.2.100.0/24"
sbg_fortigate_internal_if  = "port1"
sbg_fortigate_external_if  = "port2"

###############################################################################
# CONFIGURATION FORTIGATE - GÉNÉRAL
###############################################################################

# Port de management des Fortigates
fortigate_mgmt_port = 443

###############################################################################
# MONITORING ET ALERTES
###############################################################################

alert_emails = [
  "ops-team@exemple.com",
  "infrastructure@exemple.com"
]

alert_webhook_url = "https://hooks.slack.com/services/VOTRE/WEBHOOK/URL"

###############################################################################
# NOTES D'UTILISATION
###############################################################################
#
# 1. RÉCUPÉRER LES NOMS EXACTS DES VMs DANS VCENTER :
#    - Se connecter à vCenter via vSphere Client
#    - Aller dans l'inventaire des VMs
#    - Noter le nom EXACT (sensible à la casse)
#
# 2. RÉCUPÉRER LES IDs DES SITES ZERTO :
#    - Se connecter à la console Zerto
#    - Aller dans Sites > Manage Sites
#    - Noter les Site IDs pour RBX et SBG
#
# 3. VÉRIFIER LES NOMS DES RÉSEAUX ET DATASTORES :
#    - Dans vCenter, vérifier que les noms correspondent
#    - rbx_target_network_name doit exister dans vCenter RBX
#    - sbg_target_network_name doit exister dans vCenter SBG
#    - Les datastores doivent avoir assez d'espace (min. 240 GB pour 24h de journal)
#
# 4. GÉNÉRER UNE CLÉ API FORTIGATE :
#    - Se connecter à chaque Fortigate
#    - System > Administrators
#    - Create New > API User
#    - Copier la clé générée
#
# 5. SÉCURITÉ :
#    - Ne JAMAIS commiter terraform.tfvars dans Git
#    - Utiliser Terraform Cloud ou Vault pour les secrets
#    - Changer régulièrement les mots de passe et API keys
#
###############################################################################
